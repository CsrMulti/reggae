<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <link rel="shortcut icon" type="image/png" href="https://raw.githubusercontent.com/CsrMulti/reggae/refs/heads/main/pedrada.jpg">
    <link rel="icon" href="https://raw.githubusercontent.com/CsrMulti/reggae/refs/heads/main/pedrada.jpg" type="image/jpg">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title>TOP REGGAE</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: green;
            color: white;
            text-align: center;
        }
        #playerContainer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: black;
            padding: 10px;
            text-align: center;
            z-index: 9999;
        }
        audio {
            margin: 5px;
            width: 90%;
        }
        .bbt {
            margin: 2px;
            padding: 8px;
            border-radius: 5px;
            background: gold;
            color: black;
            font-weight: bold;
            border: none;
            cursor: pointer;
        }
        .pedrada {
            width: 100%;
        }
        p {
            margin: 3px;
        }
        h3 {
            margin: 3px;
        }
    </style>
</head>
<body>
    <img class="pedrada" src="https://raw.githubusercontent.com/CsrMulti/reggae/refs/heads/main/pedrada.jpg">
    <p>Atualizado em: <b>15/11/2024</b></p>
    <h3>PLAYLIST SÓ PEDRADA DO REGGAE</h3>
    <p id="musicaAtual">Tocando agora: Nenhuma música</p>

    <div id="playerContainer">
        <button onclick="diminuirVolume()" class="bbt">Diminuir Volume</button>
        <button onclick="player.pause()" class="bbt">Pause</button>
        <button onclick="player.play()" class="bbt">Play</button>
        <button onclick="aumentarVolume()" class="bbt">Aumentar Volume</button>
        <audio id="musicPlayer" controls autoplay>
            Seu navegador não suporta o elemento de áudio.
        </audio>
        <br>
        <button onclick="tocarAnterior()" class="bbt">Música Anterior</button>
        <button onclick="tocarProxima()" class="bbt">Próxima Música</button>
    </div>

    <script>
        // Lista de músicas
        const musicas = [
            "./01 Prisioneiro.mp3",
            "./etiopia.MP3",
            "./11_CRIMINALIDADE.MP3",
            "./certeza.mp3"
        ];

        let indiceAtual = 0;
        const player = document.getElementById("musicPlayer");

        // Atualizar o nome da música
        function atualizarNomeMusica() {
            const musicaAtual = musicas[indiceAtual].replace('./', '').replace('.mp3', '');
            document.getElementById("musicaAtual").textContent = `Tocando agora: ${musicaAtual}`;
        }

        // Carregar a primeira música
        document.addEventListener("DOMContentLoaded", () => {
            player.src = musicas[indiceAtual];
            player.play().catch(() => {
                console.log("Autoplay bloqueado. Usuário precisa interagir.");
            });
            atualizarNomeMusica();
            player.volume = 0.5;
        });

        // Tocar próxima música
        function tocarProxima() {
            indiceAtual = (indiceAtual + 1) % musicas.length;
            player.src = musicas[indiceAtual];
            player.play();
            atualizarNomeMusica();
            enviarNotificacao(); // Atualizar notificação
        }

        // Tocar música anterior
        function tocarAnterior() {
            indiceAtual = (indiceAtual - 1 + musicas.length) % musicas.length;
            player.src = musicas[indiceAtual];
            player.play();
            atualizarNomeMusica();
            enviarNotificacao(); // Atualizar notificação
        }

        // Controle de volume
        function diminuirVolume() {
            if (player.volume > 0.1) {
                player.volume -= 0.1;
            } else {
                player.volume = 0;
            }
        }

        function aumentarVolume() {
            if (player.volume < 0.9) {
                player.volume += 0.1;
            } else {
                player.volume = 1;
            }
        }

        // Função para enviar notificação
        function enviarNotificacao() {
            if ('serviceWorker' in navigator && 'PushManager' in window) {
                navigator.serviceWorker.ready.then(function(registration) {
                    registration.showNotification('TOP REGGAE', {
                        body: `Tocando agora: ${musicas[indiceAtual].replace('./', '').replace('.mp3', '')}`,
                        icon: './pedrada.jpg',
                        actions: [
                            { action: 'play', title: 'Play' },
                            { action: 'pause', title: 'Pause' },
                            { action: 'next', title: 'Próxima Música' }
                        ]
                    });
                });
            }
        }

        // Enviar notificação ao carregar
        document.addEventListener("DOMContentLoaded", enviarNotificacao);
    </script>
    <script>
        // Registrar Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./service-worker.js').then(function() {
                console.log("Service Worker registrado com sucesso!");
            }).catch(function(error) {
                console.error("Erro ao registrar Service Worker:", error);
            });
        }
        self.addEventListener('notificationclick', function(event) {
    event.notification.close();
    const action = event.action;

    switch (action) {
        case 'play':
            self.clients.matchAll().then(clients => {
                clients.forEach(client => client.postMessage('play'));
            });
            break;
        case 'pause':
            self.clients.matchAll().then(clients => {
                clients.forEach(client => client.postMessage('pause'));
            });
            break;
        case 'next':
            self.clients.matchAll().then(clients => {
                clients.forEach(client => client.postMessage('next'));
            });
            break;
        default:
            break;
    }
});

self.addEventListener('push', function(event) {
    const options = {
        body: 'Controle sua música!',
        icon: './pedrada.jpg',
        actions: [
            { action: 'play', title: 'Play' },
            { action: 'pause', title: 'Pause' },
            { action: 'next', title: 'Próxima Música' }
        ]
    };
    event.waitUntil(self.registration.showNotification('TOP REGGAE', options));
});
if ('serviceWorker' in navigator) {
    navigator.serviceWorker.addEventListener('message', function(event) {
        switch (event.data) {
            case 'play':
                player.play();
                break;
            case 'pause':
                player.pause();
                break;
            case 'next':
                tocarProxima();
                break;
        }
    });
}

    </script>
</body>
</html>
